ll = <<1, 2, 3>> ++ <<4, 5, 6>>

assert(Scalar.length(ll) == 6, "scalar error: concat length")
assert(ll == <<1, 2, 3, 4, 5, 6>>, "scalar error: concat scalar")

assert(Scalar.at(Scalar.at(<< <<1>>,<<2>>,<<42>>,<<2>> >>, 2), 0) == 42, "scalar error: nested scalar access")

### module scalar

val = Scalar.concat(<<1, 2, 3>>, <<4, 5, 6>>)

assert(Scalar.length(val) == 6, "scalar error: concat length")

assert(Scalar.tail(ll) == <<2, 3, 4, 5, 6>>, "scalar error: tail")

assert(<<{ a: 1 }>> != <<{ b: 1 }>>, "scalar error: scalar comparison")

ll = <<1, 2, 3, 4, 5>>

# Delete at
expected = <<2, 3, 4, 5>>
assert(Scalar.remove_at(ll, 0) == expected, "scalar error: scalar remove_at(ll, 0)")

expected = <<1, 2, 4, 5>>
assert(Scalar.remove_at(ll, 2) == expected, "scalar error: scalar remove_at(ll, 2)")

expected = <<1, 2, 3, 4>>
assert(Scalar.remove_at(ll, 4) == expected, "scalar error: scalar remove_at(ll, 4)")

expected = <<1, 3, 4, 5>>
assert(Scalar.remove_at(ll, 1) == expected, "scalar error: scalar remove_at(ll, 1)")

result = Scalar.remove_at(ll, 0)
|> Scalar.remove_at(0)
|> Scalar.remove_at(0)
|> Scalar.remove_at(0)
|> Scalar.remove_at(0)
assert(Scalar.is_empty(result), "scalar error: expected empty scalar")

# Insert at
expected = <<101, 1, 2, 3, 4, 5>>
assert(Scalar.insert_at(ll, 0, 101) == expected, "scalar error: scalar insert_at(ll, 0, 101)")

# Replace at
expected = <<101, 2, 3, 4, 5>>
assert(Scalar.replace_at(ll, 0, 101) == expected, "scalar error: scalar replace_at(ll, 0, 101)")

# Slice
expected = <<1, 2>>
assert(Scalar.slice(ll, 0, 2) == expected, "scalar error: slice(ll, 0, 2)")

expected = <<2>>
assert(Scalar.slice(ll, 1, 2) == expected, "scalar error: replace_at(ll, 1, 2)")

expected = <<1, 2, 3, 4, 5>>
assert(Scalar.slice(ll, 0, 5) == expected, "scalar error: slice(ll, 0, 5)")

expected = <<2, 3>>
assert(Scalar.slice(ll, -4, -2) == expected, "scalar error: slice(ll, -4, -2)")

assert(Scalar.is_empty(Scalar.slice(ll, 0, 0)), "scalar error: replace_at(ll, 1, { a: '101' }) expected empty scalar")

# Sum
expected = 15
assert(Scalar.sum(ll) == expected, "scalar error: sum(ll) is different of 15")

expected = 0
assert(Scalar.sum(<<>>) == expected, "scalar error: sum(<<>>) is different of 0")

expected = -15
assert(Scalar.sum(<<-1, -2, -3, -4, -5>>) == expected, "scalar error: sum(<<-1, -2, -3, -4, -5>>) is different of -15")

## types tests

val = <<f64 :: 1,2,3>>
assert(<<f64 :: 1,2,3>> == val, "fail to mount f64 = <<f64 :: 1,2,3>> == val")

assert(Scalar.at(<<f32::1,2,3>>, 1) == 2, "fail to mount get f32 = Scalar.at(<<f32::1,2,3>>, 1)")

assert(Scalar.at(Scalar.concat(<<f32::1,2,3>>, <<f32::4,5,6>>), 5) == 6, "fail to mount get concat f32.")

assert(Scalar.at(<<f32::1,2,3>> ++ <<f32::4,5,6>>, 5) == 6, "fail to mount get concat(++) f32.")

assert(<<f32::1,2,3>> |> Scalar.head() == 1, "fail to get head on f32")

assert(<<f32::1,2,3>> |> Scalar.tail() == <<f32::2,3>>, "fail to get tail on f32")

assert(Scalar.insert_at(<<f32::1,2,3>>, 1, 5) |> Scalar.at(1) == 5, "fail to insert_at f32")

assert(Scalar.replace_at(<<f32::1,2,3,4>>, 0, -1) |> Scalar.at(0) == -1, "fail to replace_at f32")

# i16 tests
assert(<<i16::1,2.55,3.555>> |> Scalar.sum() == 6, "fail to sum scalar i16")
list_i16 = <<i16::32767, -32768, 123, -123>>

assert(Scalar.at(list_i16, 0) == 32767, "i16 max value invalid.")

assert(Scalar.at(list_i16, 1) == -32768, "i16 min value invalid")

assert(Scalar.at(list_i16, 2) == 123, "i16 positive value invalid")

assert(Scalar.at(list_i16, 3) == -123, "i16 negative value invalid")

# Sum test for i32 scalar values
assert(<<i32::1, 2.55, 3.555>> |> Scalar.sum() == 6, "fail to sum scalar i32")

list_i32 = <<i32::2147483647, -2147483648, 100000, -100000>>

# Max and min value tests for i32
assert(Scalar.at(list_i32, 0) == 2147483647, "i32 max value invalid.")

assert(Scalar.at(list_i32, 1) == -2147483648, "i32 min value invalid")

assert(Scalar.at(list_i32, 2) == 100000, "i32 positive value invalid")

assert(Scalar.at(list_i32, 3) == -100000, "i32 negative value invalid")

## Sum test for i64 scalar values
assert(<<i64::1, 2.55, 3.555>> |> Scalar.sum() == 6, "fail to sum scalar i64")

max_i_double = 9007199254740991  # 2^53 - 1
list_i64 = <<i64::max_i_double, -max_i_double, 10000000000, -10000000000>>

# Max and min value tests for i64
assert(Scalar.at(list_i64, 0) == 9007199254740991, "i64 max value invalid.")

assert(Scalar.at(list_i64, 1) == -9007199254740991, "i64 min value invalid")

assert(Scalar.at(list_i64, 2) == 10000000000, "i64 positive value invalid")

assert(Scalar.at(list_i64, 3) == -10000000000, "i64 negative value invalid")

print("Scalar done!")

