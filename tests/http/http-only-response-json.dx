fun handle(a) do
    result = 'HTTP/1.1 200 OK\r\nContent-Type: application/json\r\n\r\n{"message": "hello"}'
    {
        data: result,
        status_code: 200
    }
end

tid = Http.start({
        port: '8080',
        request_timeout_ms: '10000',
        request_handler: &handle/1
      }, nil)

sleep(1000)

res = Os.cmd("curl -s http://localhost:8080")
assert(res == '{"message": "hello"}', "http request localhost:8080")

Http.stop(tid)
print("Http application/json done!")
